# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ CORS –æ—à–∏–±–æ–∫

## –ü—Ä–æ–±–ª–µ–º–∞

–û—à–∏–±–∫–∏ —Ç–∏–ø–∞:
```
Access to XMLHttpRequest at 'https://api.bigo.1tlt.ru/api/streams' from origin 'https://bigo-mvp.vercel.app' has been blocked by CORS policy
```

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –®–∞–≥ 1: –û–±–Ω–æ–≤–∏ CORS_ORIGIN –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

–ü–æ–¥–∫–ª—é—á–∏—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É:

```bash
ssh username@—Ç–≤–æ–π-ip-–∞–¥—Ä–µ—Å
```

–ü–µ—Ä–µ–π–¥–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é backend:

```bash
cd /var/www/bigo-mvp/backend
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π `.env` —Ñ–∞–π–ª:

```bash
sudo nano .env
```

**–ù–∞–π–¥–∏ —Å—Ç—Ä–æ–∫—É `CORS_ORIGIN` –∏ –æ–±–Ω–æ–≤–∏ –µ—ë:**

```env
CORS_ORIGIN=https://bigo-mvp.vercel.app,https://api.bigo.1tlt.ru,https://bigo.1tlt.ru,https://admin.bigo.1tlt.ru
```

**–í–∞–∂–Ω–æ:**
- –£–∫–∞–∂–∏ —Ç–æ—á–Ω—ã–π URL —Ç–≤–æ–µ–≥–æ Vercel –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (—Å `https://`)
- –†–∞–∑–¥–µ–ª—è–π URL –∑–∞–ø—è—Ç—ã–º–∏ –ë–ï–ó –ø—Ä–æ–±–µ–ª–æ–≤
- –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ –¥–æ–º–µ–Ω—ã, –¥–æ–±–∞–≤—å –∏—Ö —Ç–æ–∂–µ

**–°–æ—Ö—Ä–∞–Ω–∏:** `Ctrl+X`, `Y`, `Enter`

### –®–∞–≥ 2: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ Backend

```bash
pm2 restart bigo-backend
```

–ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏:

```bash
pm2 logs bigo-backend --lines 30
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ –∑–∞–ø—É—Å–∫–µ –±–µ–∑ –æ—à–∏–±–æ–∫.

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å —Ä–∞–±–æ—Ç—É

–û—Ç–∫—Ä–æ–π Web –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ –ø—Ä–æ–≤–µ—Ä—å:
- –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Å—Ç—Ä–∏–º–æ–≤
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- –í—Ö–æ–¥

–í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å CORS –æ—à–∏–±–æ–∫.

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ CORS

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏:

```bash
cd /var/www/bigo-mvp/backend
cat .env | grep CORS_ORIGIN
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ:
```
CORS_ORIGIN=https://bigo-mvp.vercel.app,https://api.bigo.1tlt.ru
```

---

## üêõ –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –í—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∞!)

```bash
cd /var/www/bigo-mvp/backend
sudo nano .env
```

–ò–∑–º–µ–Ω–∏ –Ω–∞:
```env
CORS_ORIGIN=*
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏:
```bash
pm2 restart bigo-backend
```

**‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ:** –≠—Ç–æ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞! –ò—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∞.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω

```bash
pm2 status
```

–î–æ–ª–∂–µ–Ω –±—ã—Ç—å `online` —Å—Ç–∞—Ç—É—Å.

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Apache

```bash
sudo tail -f /var/log/apache2/error.log
```

–ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è, –∏—Å–ø—Ä–∞–≤—å –∏—Ö.

### –í–∞—Ä–∏–∞–Ω—Ç 4: –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ API –¥–æ—Å—Ç—É–ø–µ–Ω

```bash
curl https://api.bigo.1tlt.ru/api/health
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: `{"status":"ok","timestamp":"..."}`

---

## üìù –ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ .env

```env
PORT=5000
MONGODB_URI=mongodb+srv://...
JWT_SECRET=—Ç–≤–æ–π-—Å–µ–∫—Ä–µ—Ç
JWT_EXPIRE=7d
CORS_ORIGIN=https://bigo-mvp.vercel.app,https://api.bigo.1tlt.ru,https://bigo.1tlt.ru,https://admin.bigo.1tlt.ru
NODE_ENV=production
```

---

## ‚úÖ –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. Backend –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã —Å Vercel
2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å
3. –í—Ö–æ–¥ –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å
4. –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∏–º–æ–≤ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å
5. –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å CORS –æ—à–∏–±–æ–∫

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ)

–ö–æ–¥ backend —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –ª—É—á—à–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ CORS. –ï—Å–ª–∏ —Ç—ã –æ–±–Ω–æ–≤–∏–ª –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
cd /var/www/bigo-mvp
sudo git pull origin main
cd backend
sudo npm install
pm2 restart bigo-backend
```

–ì–æ—Ç–æ–≤–æ! üöÄ

