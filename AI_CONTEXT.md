# AI Context

## Текущее состояние

### Превью стримов на главной странице:
- Реализован компонент `StreamCard` с превью кадром из видео
- Добавлен отдельный блок для отображения превью кадра под проигрывателем (для отладки)
- Превью кадр захватывается из видео потока через canvas
- Кнопка play поверх превью для запуска видео
- Используется компонент `StreamPlayer` для воспроизведения после нажатия на play

### Проблемы:
1. Превью кадр не всегда захватывается (нет картинки для превью)
2. Видео нестабильно запускается на мобильных устройствах - иногда работает, иногда нет, требуется обновление страницы
3. Ошибки WebRTC: "Called in wrong state: stable" при обработке offer/answer

### Улучшения:
- Добавлена обработка ошибок WebRTC с проверкой состояния соединения
- Улучшен запуск видео с ожиданием готовности перед play()
- Добавлен отдельный блок для отладки превью кадра

## Следующий шаг

1. Исправить захват превью кадра - убедиться, что `capturePreviewFrame()` вызывается корректно и кадр отрисовывается на canvas
2. Улучшить стабильность запуска видео на мобильных - добавить повторные попытки подключения и обработку ошибок автоплея
3. Исправить ошибки WebRTC "wrong state" - улучшить синхронизацию состояния RTCPeerConnection



